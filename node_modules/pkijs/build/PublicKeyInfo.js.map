{"version":3,"sources":["../src/PublicKeyInfo.js"],"names":["PublicKeyInfo","constructor","parameters","algorithm","defaultValues","subjectPublicKey","parsedKey","fromSchema","schema","fromJSON","json","memberName","AlgorithmIdentifier","asn1js","BitString","Error","names","Sequence","name","blockName","value","asn1","compareSchema","verified","result","algorithmId","algorithmParams","ObjectIdentifier","ECPublicKey","namedCurve","valueBlock","toString","valueHex","ex","publicKeyASN1","fromBER","offset","RSAPublicKey","toSchema","toJSON","jwk","kty","publicKeyJWK","Object","keys","key","toUpperCase","Null","toBER","importKey","publicKey","sequence","Promise","resolve","_this","reject","crypto","then","exportKey","exportedKey","exception","undefined","error"],"mappings":"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","sourcesContent":["import * as asn1js from \"asn1js\";\nimport { getParametersValue, clearProps } from \"pvutils\";\nimport { getCrypto } from \"./common.js\";\nimport AlgorithmIdentifier from \"./AlgorithmIdentifier.js\";\nimport ECPublicKey from \"./ECPublicKey.js\";\nimport RSAPublicKey from \"./RSAPublicKey.js\";\n//**************************************************************************************\n/**\n * Class from RFC5280\n */\nexport default class PublicKeyInfo \n{\n\t//**********************************************************************************\n\t/**\n\t * Constructor for PublicKeyInfo class\n\t * @param {Object} [parameters={}]\n\t * @param {Object} [parameters.schema] asn1js parsed value to initialize the class from\n\t */\n\tconstructor(parameters = {})\n\t{\n\t\t//region Internal properties of the object\n\t\t/**\n\t\t * @type {AlgorithmIdentifier}\n\t\t * @desc Algorithm identifier\n\t\t */\n\t\tthis.algorithm = getParametersValue(parameters, \"algorithm\", PublicKeyInfo.defaultValues(\"algorithm\"));\n\t\t/**\n\t\t * @type {BitString}\n\t\t * @desc Subject public key value\n\t\t */\n\t\tthis.subjectPublicKey = getParametersValue(parameters, \"subjectPublicKey\", PublicKeyInfo.defaultValues(\"subjectPublicKey\"));\n\t\t\n\t\tif(\"parsedKey\" in parameters)\n\t\t\t/**\n\t\t\t * @type {ECPublicKey|RSAPublicKey}\n\t\t\t * @desc Parsed public key value\n\t\t\t */\n\t\t\tthis.parsedKey = getParametersValue(parameters, \"parsedKey\", PublicKeyInfo.defaultValues(\"parsedKey\"));\n\t\t//endregion\n\t\t\n\t\t//region If input argument array contains \"schema\" for this object\n\t\tif(\"schema\" in parameters)\n\t\t\tthis.fromSchema(parameters.schema);\n\t\t//endregion\n\t\t//region If input argument array contains \"json\" for this object\n\t\tif(\"json\" in parameters)\n\t\t\tthis.fromJSON(parameters.json);\n\t\t//endregion\n\t}\n\t//**********************************************************************************\n\t/**\n\t * Return default values for all class members\n\t * @param {string} memberName String name for a class member\n\t */\n\tstatic defaultValues(memberName)\n\t{\n\t\tswitch(memberName)\n\t\t{\n\t\t\tcase \"algorithm\":\n\t\t\t\treturn new AlgorithmIdentifier();\n\t\t\tcase \"subjectPublicKey\":\n\t\t\t\treturn new asn1js.BitString();\n\t\t\tdefault:\n\t\t\t\tthrow new Error(`Invalid member name for PublicKeyInfo class: ${memberName}`);\n\t\t}\n\t}\n\t//**********************************************************************************\n\t/**\n\t * Return value of pre-defined ASN.1 schema for current class\n\t *\n\t * ASN.1 schema:\n\t * ```asn1\n\t * SubjectPublicKeyInfo  ::=  Sequence  {\n\t *    algorithm            AlgorithmIdentifier,\n\t *    subjectPublicKey     BIT STRING  }\n\t * ```\n\t *\n\t * @param {Object} parameters Input parameters for the schema\n\t * @returns {Object} asn1js schema object\n\t */\n\tstatic schema(parameters = {})\n\t{\n\t\t/**\n\t\t * @type {Object}\n\t\t * @property {string} [blockName]\n\t\t * @property {string} [algorithm]\n\t\t * @property {string} [subjectPublicKey]\n\t\t */\n\t\tconst names = getParametersValue(parameters, \"names\", {});\n\t\t\n\t\treturn (new asn1js.Sequence({\n\t\t\tname: (names.blockName || \"\"),\n\t\t\tvalue: [\n\t\t\t\tAlgorithmIdentifier.schema(names.algorithm || {}),\n\t\t\t\tnew asn1js.BitString({ name: (names.subjectPublicKey || \"\") })\n\t\t\t]\n\t\t}));\n\t}\n\t//**********************************************************************************\n\t/**\n\t * Convert parsed asn1js object into current class\n\t * @param {!Object} schema\n\t */\n\tfromSchema(schema)\n\t{\n\t\t//region Clear input data first\n\t\tclearProps(schema, [\n\t\t\t\"algorithm\",\n\t\t\t\"subjectPublicKey\"\n\t\t]);\n\t\t//endregion\n\t\t\n\t\t//region Check the schema is valid\n\t\tconst asn1 = asn1js.compareSchema(schema,\n\t\t\tschema,\n\t\t\tPublicKeyInfo.schema({\n\t\t\t\tnames: {\n\t\t\t\t\talgorithm: {\n\t\t\t\t\t\tnames: {\n\t\t\t\t\t\t\tblockName: \"algorithm\"\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tsubjectPublicKey: \"subjectPublicKey\"\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\t\t\n\t\tif(asn1.verified === false)\n\t\t\tthrow new Error(\"Object's schema was not verified against input data for PublicKeyInfo\");\n\t\t//endregion\n\t\t\n\t\t//region Get internal properties from parsed schema\n\t\tthis.algorithm = new AlgorithmIdentifier({ schema: asn1.result.algorithm });\n\t\tthis.subjectPublicKey = asn1.result.subjectPublicKey;\n\t\t\n\t\tswitch(this.algorithm.algorithmId)\n\t\t{\n\t\t\tcase \"1.2.840.10045.2.1\": // ECDSA\n\t\t\t\tif(\"algorithmParams\" in this.algorithm)\n\t\t\t\t{\n\t\t\t\t\tif(this.algorithm.algorithmParams.constructor.blockName() === asn1js.ObjectIdentifier.blockName())\n\t\t\t\t\t{\n\t\t\t\t\t\ttry\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.parsedKey = new ECPublicKey({\n\t\t\t\t\t\t\t\tnamedCurve: this.algorithm.algorithmParams.valueBlock.toString(),\n\t\t\t\t\t\t\t\tschema: this.subjectPublicKey.valueBlock.valueHex\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcatch(ex){} // Could be a problems during recognision of internal public key data here. Let's ignore them.\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"1.2.840.113549.1.1.1\": // RSA\n\t\t\t\t{\n\t\t\t\t\tconst publicKeyASN1 = asn1js.fromBER(this.subjectPublicKey.valueBlock.valueHex);\n\t\t\t\t\tif(publicKeyASN1.offset !== (-1))\n\t\t\t\t\t{\n\t\t\t\t\t\ttry\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.parsedKey = new RSAPublicKey({ schema: publicKeyASN1.result });\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcatch(ex){} // Could be a problems during recognision of internal public key data here. Let's ignore them.\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t}\n\t\t//endregion\n\t}\n\t//**********************************************************************************\n\t/**\n\t * Convert current object to asn1js object and set correct values\n\t * @returns {Object} asn1js object\n\t */\n\ttoSchema()\n\t{\n\t\t//region Construct and return new ASN.1 schema for this object\n\t\treturn (new asn1js.Sequence({\n\t\t\tvalue: [\n\t\t\t\tthis.algorithm.toSchema(),\n\t\t\t\tthis.subjectPublicKey\n\t\t\t]\n\t\t}));\n\t\t//endregion\n\t}\n\t//**********************************************************************************\n\t/**\n\t * Convertion for the class to JSON object\n\t * @returns {Object}\n\t */\n\ttoJSON()\n\t{\n\t\t//region Return common value in case we do not have enough info fo making JWK\n\t\tif((\"parsedKey\" in this) === false)\n\t\t{\n\t\t\treturn {\n\t\t\t\talgorithm: this.algorithm.toJSON(),\n\t\t\t\tsubjectPublicKey: this.subjectPublicKey.toJSON()\n\t\t\t};\n\t\t}\n\t\t//endregion\n\t\t\n\t\t//region Making JWK\n\t\tconst jwk = {};\n\t\t\n\t\tswitch(this.algorithm.algorithmId)\n\t\t{\n\t\t\tcase \"1.2.840.10045.2.1\": // ECDSA\n\t\t\t\tjwk.kty = \"EC\";\n\t\t\t\tbreak;\n\t\t\tcase \"1.2.840.113549.1.1.1\": // RSA\n\t\t\t\tjwk.kty = \"RSA\";\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t}\n\t\t\n\t\tconst publicKeyJWK = this.parsedKey.toJSON();\n\t\t\n\t\tfor(const key of Object.keys(publicKeyJWK))\n\t\t\tjwk[key] = publicKeyJWK[key];\n\t\t\n\t\treturn jwk;\n\t\t//endregion\n\t}\n\t//**********************************************************************************\n\t/**\n\t * Convert JSON value into current object\n\t * @param {Object} json\n\t */\n\tfromJSON(json)\n\t{\n\t\tif(\"kty\" in json)\n\t\t{\n\t\t\tswitch(json.kty.toUpperCase())\n\t\t\t{\n\t\t\t\tcase \"EC\":\n\t\t\t\t\tthis.parsedKey = new ECPublicKey({ json });\n\t\t\t\t\t\n\t\t\t\t\tthis.algorithm = new AlgorithmIdentifier({\n\t\t\t\t\t\talgorithmId: \"1.2.840.10045.2.1\",\n\t\t\t\t\t\talgorithmParams: new asn1js.ObjectIdentifier({ value: this.parsedKey.namedCurve })\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"RSA\":\n\t\t\t\t\tthis.parsedKey = new RSAPublicKey({ json });\n\t\t\t\t\t\n\t\t\t\t\tthis.algorithm = new AlgorithmIdentifier({\n\t\t\t\t\t\talgorithmId: \"1.2.840.113549.1.1.1\",\n\t\t\t\t\t\talgorithmParams: new asn1js.Null()\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new Error(`Invalid value for \"kty\" parameter: ${json.kty}`);\n\t\t\t}\n\t\t\t\n\t\t\tthis.subjectPublicKey = new asn1js.BitString({ valueHex: this.parsedKey.toSchema().toBER(false) });\n\t\t}\n\t}\n\t//**********************************************************************************\n\timportKey(publicKey)\n\t{\n\t\t//region Initial variables\n\t\tlet sequence = Promise.resolve();\n\t\tconst _this = this;\n\t\t//endregion\n\t\t\n\t\t//region Initial check\n\t\tif(typeof publicKey === \"undefined\")\n\t\t\treturn Promise.reject(\"Need to provide publicKey input parameter\");\n\t\t//endregion\n\t\t\n\t\t//region Get a \"crypto\" extension\n\t\tconst crypto = getCrypto();\n\t\tif(typeof crypto === \"undefined\")\n\t\t\treturn Promise.reject(\"Unable to create WebCrypto object\");\n\t\t//endregion\n\t\t\n\t\t//region Export public key\n\t\tsequence = sequence.then(() =>\n\t\t\tcrypto.exportKey(\"spki\", publicKey));\n\t\t//endregion\n\t\t\n\t\t//region Initialize internal variables by parsing exported value\n\t\tsequence = sequence.then(\n\t\t\t/**\n\t\t\t * @param {ArrayBuffer} exportedKey\n\t\t\t */\n\t\t\texportedKey =>\n\t\t\t{\n\t\t\t\tconst asn1 = asn1js.fromBER(exportedKey);\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\t_this.fromSchema(asn1.result);\n\t\t\t\t}\n\t\t\t\tcatch(exception)\n\t\t\t\t{\n\t\t\t\t\treturn Promise.reject(\"Error during initializing object from schema\");\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn undefined;\n\t\t\t},\n\t\t\terror => Promise.reject(`Error during exporting public key: ${error}`)\n\t\t);\n\t\t//endregion\n\t\t\n\t\treturn sequence;\n\t}\n\t//**********************************************************************************\n}\n//**************************************************************************************\n"],"file":"PublicKeyInfo.js"}