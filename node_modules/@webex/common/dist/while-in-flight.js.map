{"version":3,"sources":["while-in-flight.js"],"names":["whileInFlight","param","whileInFlightDecorator","target","name","descriptor","value","whileInFlightExecutor","fn","args","resolve","then","catch","reason","reject"],"mappings":";;;;;;;;;;;;;;;;;;AAQA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACe,SAASA,aAAT,CAAuBC,KAAvB,EAA8B;AAC3C,SAAO,SAASC,sBAAT,CAAgCC,MAAhC,EAAwCC,IAAxC,EAA8CC,UAA9C,EAA0D;AAC/DA,IAAAA,UAAU,CAACC,KAAX,GAAmB,oBAAKD,UAAU,CAACC,KAAhB,EAAuB,SAASC,qBAAT,CAA+BC,EAA/B,EAA4C;AAAA;;AAAA,wCAANC,IAAM;AAANA,QAAAA,IAAM;AAAA;;AACpF,aAAO,qBAAY,UAACC,OAAD,EAAa;AAC9B,QAAA,KAAI,CAACT,KAAD,CAAJ,GAAc,IAAd;AACAS,QAAAA,OAAO,CAAC,oBAAcF,EAAd,EAAkB,KAAlB,EAAwBC,IAAxB,EACLE,IADK,CACA,kBAAI,YAAM;AACd,UAAA,KAAI,CAACV,KAAD,CAAJ,GAAc,KAAd;AACD,SAFK,CADA,EAILW,KAJK,CAIC,UAACC,MAAD,EAAY;AACjB,UAAA,KAAI,CAACZ,KAAD,CAAJ,GAAc,KAAd;AAEA,iBAAO,iBAAQa,MAAR,CAAeD,MAAf,CAAP;AACD,SARK,CAAD,CAAP;AASD,OAXM,CAAP;AAYD,KAbkB,CAAnB;AAcD,GAfD;AAgBD","sourcesContent":["/*!\n * Copyright (c) 2015-2020 Cisco Systems, Inc. See LICENSE file.\n */\n\n/* eslint no-invalid-this: [0] */\n\nimport {wrap} from 'lodash';\n\nimport tap from './tap';\n\n/**\n * While the promise returned by the decorated is unfullfilled, sets, the\n * specified boolean on the target class to `true`\n * @param {string} param\n * @returns {Function}\n */\nexport default function whileInFlight(param) {\n  return function whileInFlightDecorator(target, name, descriptor) {\n    descriptor.value = wrap(descriptor.value, function whileInFlightExecutor(fn, ...args) {\n      return new Promise((resolve) => {\n        this[param] = true;\n        resolve(Reflect.apply(fn, this, args)\n          .then(tap(() => {\n            this[param] = false;\n          }))\n          .catch((reason) => {\n            this[param] = false;\n\n            return Promise.reject(reason);\n          }));\n      });\n    });\n  };\n}\n"]}