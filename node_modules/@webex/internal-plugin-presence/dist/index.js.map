{"version":3,"sources":["index.js"],"names":["Presence","payloadTransformer","predicates","name","direction","test","ctx","response","resolve","extract","transforms","fn","body","status","eventType","config"],"mappings":";;;;;;;;;;;;;;;;;;;;;AAIA;;AAEA;;AAGA;;AACA;;AAVA;AACA;AACA;AAUA,uCAAuB,UAAvB,EAAmCA,iBAAnC,EAA6C;AAC3CC,EAAAA,kBAAkB,EAAE;AAClBC,IAAAA,UAAU,EAAE,CACV;AACEC,MAAAA,IAAI,EAAE,+BADR;AAEEC,MAAAA,SAAS,EAAE,SAFb;AAGEC,MAAAA,IAHF,gBAGOC,GAHP,EAGYC,QAHZ,EAGsB;AAClB;AACA,eAAO,iBAAQC,OAAR,CAAgB,mBAAID,QAAJ,EAAc,gBAAd,KAAmC,mBAAIA,QAAJ,EAAc,cAAd,CAAnD,CAAP;AACD,OANH;AAOEE,MAAAA,OAPF,mBAOUF,QAPV,EAOoB;AAChB,eAAO,iBAAQC,OAAR,CAAgBD,QAAhB,CAAP;AACD;AATH,KADU,CADM;AAclBG,IAAAA,UAAU,EAAE,CACV;AACEP,MAAAA,IAAI,EAAE,+BADR;AAEEC,MAAAA,SAAS,EAAE,SAFb;AAGEO,MAAAA,EAHF,cAGKL,GAHL,EAGUC,QAHV,EAGoB;AAChBA,QAAAA,QAAQ,CAACK,IAAT,CAAcC,MAAd,GAAuBN,QAAQ,CAACK,IAAT,CAAcE,SAArC;AACD;AALH,KADU;AAdM,GADuB;AAyB3CC,EAAAA,MAAM,EAANA;AAzB2C,CAA7C","sourcesContent":["/*!\n * Copyright (c) 2015-2020 Cisco Systems, Inc. See LICENSE file.\n */\n\nimport '@webex/internal-plugin-device';\n\nimport {registerInternalPlugin} from '@webex/webex-core';\nimport {has} from 'lodash';\n\nimport Presence from './presence';\nimport config from './config';\n\nregisterInternalPlugin('presence', Presence, {\n  payloadTransformer: {\n    predicates: [\n      {\n        name: 'normalizeSingleStatusResponse',\n        direction: 'inbound',\n        test(ctx, response) {\n          // POST to /apheleia/api/v1/events\n          return Promise.resolve(has(response, 'body.eventType') && has(response, 'body.subject'));\n        },\n        extract(response) {\n          return Promise.resolve(response);\n        }\n      }\n    ],\n    transforms: [\n      {\n        name: 'normalizeSingleStatusResponse',\n        direction: 'inbound',\n        fn(ctx, response) {\n          response.body.status = response.body.eventType;\n        }\n      }\n    ]\n  },\n  config\n});\n\nexport {default} from './presence';\n"]}