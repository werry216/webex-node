{"version":3,"sources":["credentials-config.js"],"names":["CredentialsConfig","AmpState","extend","extraProperties","props","idbroker","url","process","env","IDBROKER_BASE_URL","identity","IDENTITY_BASE_URL","authorizationString","WEBEX_AUTHORIZATION_STRING","AUTHORIZATION_STRING","authorizeUrl","WEBEX_AUTHORIZE_URL","client_id","WEBEX_CLIENT_ID","COMMON_IDENTITY_CLIENT_ID","CLIENT_ID","client_secret","WEBEX_CLIENT_SECRET","COMMON_IDENTITY_CLIENT_SECRET","CLIENT_SECRET","redirect_uri","WEBEX_REDIRECT_URI","COMMON_IDENTITY_REDIRECT_URI","REDIRECT_URI","scope","WEBEX_SCOPE","WEBEX_SCOPES","COMMON_IDENTITY_SCOPE","SCOPE","cisService","derived","activationUrl","deps","fn","cache","tokenUrl","TOKEN_URL","revokeUrl","REVOKE_URL","logoutUrl","setPasswordUrl"],"mappings":"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","sourcesContent":["import AmpState from 'ampersand-state';\n\n// The credentials config which includes the CI server info and derived\n// URL properties from them for the various CI services.  The URL's\n// will be updated when the CI changes.\nconst CredentialsConfig = AmpState.extend({\n\n  // we need to allow extra props for dynamic props like jwtRefreshCallback\n  extraProperties: 'allow',\n\n  props: {\n    /**\n     * The idbroker base host name\n     * @returns {object}\n     */\n    idbroker: ['object', false, (() => ({\n      url: process.env.IDBROKER_BASE_URL || 'https://idbroker.webex.com'\n    }))],\n\n    /**\n     * The identity base host name\n     * @returns {object}\n     */\n    identity: ['object', false, (() => ({\n      url: process.env.IDENTITY_BASE_URL || 'https://identity.webex.com'\n    }))],\n\n    /**\n      * This is the authorization url displayed on the\n      * {@link developer portal|https://developer.webex.com}\n      * @type {string}\n      */\n    authorizationString: ['string', false, process.env.WEBEX_AUTHORIZATION_STRING || process.env.AUTHORIZATION_STRING],\n\n    /**\n     * Authorization URL which prompts for user's password. Inferred from\n     * {@link config.credentials.authorizationString}. This config value will\n     * be automatically set if `authorizationString` config value is specified.\n     *\n     * @type {string}\n     */\n    authorizeUrl: [\n      'string',\n      false,\n      process.env.WEBEX_AUTHORIZE_URL ||\n       `${process.env.IDBROKER_BASE_URL || 'https://idbroker.webex.com'}/idb/oauth2/v1/authorize`\n    ],\n\n    /**\n      * {@see https://tools.ietf.org/html/rfc6749#section-4.1.4}\n      * @type {string}\n      */\n    client_id: ['string', false, process.env.WEBEX_CLIENT_ID || process.env.COMMON_IDENTITY_CLIENT_ID || process.env.CLIENT_ID],\n\n    /**\n      * {@see https://tools.ietf.org/html/rfc6749#section-4.1.4}\n      * @type {string}\n      */\n    client_secret: ['string', false, process.env.WEBEX_CLIENT_SECRET || process.env.COMMON_IDENTITY_CLIENT_SECRET || process.env.CLIENT_SECRET],\n\n    /**\n      * {@see https://tools.ietf.org/html/rfc6749#section-4.1.4}\n      * @type {string}\n      */\n    redirect_uri: ['string', false, process.env.WEBEX_REDIRECT_URI || process.env.COMMON_IDENTITY_REDIRECT_URI || process.env.REDIRECT_URI],\n\n    /**\n      * {@see https://tools.ietf.org/html/rfc6749#section-4.1.4}\n      * @type {string}\n      */\n    scope: ['string', false, process.env.WEBEX_SCOPE || process.env.WEBEX_SCOPES || process.env.COMMON_IDENTITY_SCOPE || process.env.SCOPE],\n\n    /**\n      * Controls the UI of the CI login page.\n      * @private\n      * @type {string}\n      */\n    cisService: ['string', false, 'webex']\n  },\n\n  derived: {\n    /**\n      * User activation URL\n      * {@link config.credentials.activationUrl}\n      * @type {string}\n      */\n    activationUrl: {\n      deps: ['idbroker.url'],\n      fn() {\n        return `${this.idbroker.url || 'https://idbroker.webex.com'}/idb/token/v1/actions/UserActivation/invoke`;\n      },\n      cache: false\n    },\n\n    // TODO does hydra also have an access_token endpoint?\n    /**\n      * Token URL used for token refresh and auth code exchange\n      * @type {string}\n      */\n    tokenUrl: {\n      deps: ['idbroker.url'],\n      fn() {\n        return process.env.TOKEN_URL || `${this.idbroker.url}/idb/oauth2/v1/access_token`;\n      },\n      cache: false\n    },\n\n    /**\n      * URL to revoke token\n      * @type {string}\n      */\n    revokeUrl: {\n      deps: ['idbroker.url'],\n      fn() {\n        return process.env.REVOKE_URL || `${this.idbroker.url}/idb/oauth2/v1/revoke`;\n      },\n      cache: false\n    },\n\n    /**\n      * URL to load when the app logs out\n      * @type {string}\n      */\n    logoutUrl: {\n      deps: ['idbroker.url'],\n      fn() {\n        return `${this.idbroker.url}/idb/oauth2/v1/logout`;\n      },\n      cache: false\n    },\n\n    /**\n      * Set password URL\n      * @type {string}\n      */\n    setPasswordUrl: {\n      deps: ['identity.url'],\n      fn() {\n        return `${this.identity.url || 'https://identity.webex.com'}/identity/scim/v1/Users`;\n      },\n      cache: false\n    }\n\n  }\n\n});\n\nexport default CredentialsConfig;\n"]}